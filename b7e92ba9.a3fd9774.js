(window.webpackJsonp=window.webpackJsonp||[]).push([[41],{106:function(e,t,a){"use strict";a.r(t),a.d(t,"frontMatter",(function(){return o})),a.d(t,"metadata",(function(){return c})),a.d(t,"rightToc",(function(){return l})),a.d(t,"default",(function(){return b}));var n=a(3),r=a(7),i=(a(0),a(121)),o={title:"Date and Time Functions"},c={unversionedId:"formula/function_date",id:"formula/function_date",isDocsHomePage:!1,title:"Date and Time Functions",description:"ADDMONTHS",source:"@site/docs/formula/function_date.md",slug:"/formula/function_date",permalink:"/docs/formula/function_date",editUrl:"https://github.com/steedos/steedos.org/tree/master/docs/formula/function_date.md",version:"current"},l=[{value:"ADDMONTHS",id:"addmonths",children:[]},{value:"DATE",id:"date",children:[]},{value:"DATEVALUE",id:"datevalue",children:[]},{value:"DATETIMEVALUE",id:"datetimevalue",children:[]}],d={rightToc:l};function b(e){var t=e.components,a=Object(r.a)(e,["components"]);return Object(i.b)("wrapper",Object(n.a)({},d,a,{components:t,mdxType:"MDXLayout"}),Object(i.b)("h2",{id:"addmonths"},"ADDMONTHS"),Object(i.b)("p",null,"The date returned is the specified number of months before or after the specified date. If the number of days in the remaining month is less than the starting month, the function returns the last day of the remaining month. Otherwise, the result contains the same day component as the specified date."),Object(i.b)("p",null,Object(i.b)("strong",{parentName:"p"},"Use\uff1a")," ",Object(i.b)("inlineCode",{parentName:"p"},"ADDMONTHS (date/datetime,number)")," ,Replace ",Object(i.b)("inlineCode",{parentName:"p"},"date/datetime"),"and ",Object(i.b)("inlineCode",{parentName:"p"},"number")," with the start date and the number of months added."),Object(i.b)("p",null,Object(i.b)("strong",{parentName:"p"},"Parameter\uff1a")),Object(i.b)("ul",null,Object(i.b)("li",{parentName:"ul"},Object(i.b)("em",{parentName:"li"},"Date, date time:")," ",Object(i.b)("inlineCode",{parentName:"li"},"date/datetime"),"\nDate or date time, indicating the start date"),Object(i.b)("li",{parentName:"ul"},Object(i.b)("em",{parentName:"li"},"Number:")," ",Object(i.b)("inlineCode",{parentName:"li"},"number"),"\nValue, indicating the number of months to increase.")),Object(i.b)("p",null,Object(i.b)("strong",{parentName:"p"},"Return value\uff1a")," date"),Object(i.b)("pre",null,Object(i.b)("code",Object(n.a)({parentName:"pre"},{className:"language-js"}),"ADDMONTHS (StartDate, 5)\n")),Object(i.b)("p",null,"Add 5 months for the start date. For example, if the start date is September 20, 2017, the result date is February 20, 2018; if the start date is September 30, 2017, the result date is February 28, 2018."),Object(i.b)("div",{className:"admonition admonition-note alert alert--secondary"},Object(i.b)("div",Object(n.a)({parentName:"div"},{className:"admonition-heading"}),Object(i.b)("h5",{parentName:"div"},Object(i.b)("span",Object(n.a)({parentName:"h5"},{className:"admonition-icon"}),Object(i.b)("svg",Object(n.a)({parentName:"span"},{xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"}),Object(i.b)("path",Object(n.a)({parentName:"svg"},{fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"})))),"Tip")),Object(i.b)("div",Object(n.a)({parentName:"div"},{className:"admonition-content"}),Object(i.b)("p",{parentName:"div"},"Parameters of date or date time type are supported, but the return value is always of date type instead of date time ty."))),Object(i.b)("h2",{id:"date"},"DATE"),Object(i.b)("p",null,"Returns a date value from the year, month, and day values you entered. If the date function value in the formula field is an invalid date, an error message is returned."),Object(i.b)("p",null,Object(i.b)("strong",{parentName:"p"},"Use\uff1a")," ",Object(i.b)("inlineCode",{parentName:"p"},"DATE(Year, Month,Day)")," ,Replace the year with a four digit year, the month with a two digit month, and the day with a two digit date."),Object(i.b)("p",null,Object(i.b)("strong",{parentName:"p"},"Parameter\uff1a")),Object(i.b)("ul",null,Object(i.b)("li",{parentName:"ul"},Object(i.b)("em",{parentName:"li"},"Year:")," ",Object(i.b)("inlineCode",{parentName:"li"},"number"),"\nFour digit year."),Object(i.b)("li",{parentName:"ul"},Object(i.b)("em",{parentName:"li"},"Month:")," ",Object(i.b)("inlineCode",{parentName:"li"},"number"),"\nA numeric value that represents the value of the month."),Object(i.b)("li",{parentName:"ul"},Object(i.b)("em",{parentName:"li"},"Day:")," ",Object(i.b)("inlineCode",{parentName:"li"},"number"),"\nRepresents the value of the day part.")),Object(i.b)("p",null,Object(i.b)("strong",{parentName:"p"},"Return value\uff1a")," date"),Object(i.b)("pre",null,Object(i.b)("code",Object(n.a)({parentName:"pre"},{className:"language-js"}),"DATE(2005, 1, 2)\n")),Object(i.b)("p",null,"Create a date field on January 2, 2005."),Object(i.b)("div",{className:"admonition admonition-note alert alert--secondary"},Object(i.b)("div",Object(n.a)({parentName:"div"},{className:"admonition-heading"}),Object(i.b)("h5",{parentName:"div"},Object(i.b)("span",Object(n.a)({parentName:"h5"},{className:"admonition-icon"}),Object(i.b)("svg",Object(n.a)({parentName:"span"},{xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"}),Object(i.b)("path",Object(n.a)({parentName:"svg"},{fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"})))),"Tip")),Object(i.b)("div",Object(n.a)({parentName:"div"},{className:"admonition-content"}),Object(i.b)("p",{parentName:"div"},"The number of parameters can only be three, and incoming strings `2005-01-01'are not supported."))),Object(i.b)("div",{className:"admonition admonition-note alert alert--secondary"},Object(i.b)("div",Object(n.a)({parentName:"div"},{className:"admonition-heading"}),Object(i.b)("h5",{parentName:"div"},Object(i.b)("span",Object(n.a)({parentName:"h5"},{className:"admonition-icon"}),Object(i.b)("svg",Object(n.a)({parentName:"span"},{xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"}),Object(i.b)("path",Object(n.a)({parentName:"svg"},{fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"})))),"Note")),Object(i.b)("div",Object(n.a)({parentName:"div"},{className:"admonition-content"}),Object(i.b)("p",{parentName:"div"},"When the format of the incoming function parameter is correct, but the value does not conform to the specification, an error will not be reported, but a possible error value will be returned. For example, for non leap year, date (2021,2,29) will return 2021-03-01, and date (2021,121,29) will return 2031-01-29."))),Object(i.b)("h2",{id:"datevalue"},"DATEVALUE"),Object(i.b)("p",null,"Returns a date value for a date, datetime, or text expressi."),Object(i.b)("p",null,Object(i.b)("strong",{parentName:"p"},"Use\uff1a")," DATEVALUE(Expression)"),Object(i.b)("p",null,Object(i.b)("strong",{parentName:"p"},"Parameter\uff1a")," ",Object(i.b)("inlineCode",{parentName:"p"},"date/datetime/text"),"\nA combined field or expression for a date, datetime, or text value in date, datetime format."),Object(i.b)("p",null,Object(i.b)("strong",{parentName:"p"},"Return value\uff1a")," date"),Object(i.b)("pre",null,Object(i.b)("code",Object(n.a)({parentName:"pre"},{className:"language-js"}),"DATEVALUE(ClosedDate)\n")),Object(i.b)("p",null,"The date value is displayed based on the value of the end date time field. The parameter closeddate can be a date or date time type, or a string type of date or date time format."),Object(i.b)("pre",null,Object(i.b)("code",Object(n.a)({parentName:"pre"},{className:"language-js"}),'DATEVALUE("2005-1-15 12:30")\n')),Object(i.b)("p",null,'Returns "2005-01-15" as a date value.'),Object(i.b)("div",{className:"admonition admonition-note alert alert--secondary"},Object(i.b)("div",Object(n.a)({parentName:"div"},{className:"admonition-heading"}),Object(i.b)("h5",{parentName:"div"},Object(i.b)("span",Object(n.a)({parentName:"h5"},{className:"admonition-icon"}),Object(i.b)("svg",Object(n.a)({parentName:"span"},{xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"}),Object(i.b)("path",Object(n.a)({parentName:"svg"},{fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"})))),"\u6280\u5de7\u63d0\u793a")),Object(i.b)("div",Object(n.a)({parentName:"div"},{className:"admonition-content"}),Object(i.b)("ul",{parentName:"div"},Object(i.b)("li",{parentName:"ul"},'\u25a0 If the field referenced in the function is not a valid text or date time field, the field in the formula may be displayed as an exception string or error message. For example, data value ("2005-111-15") will return Nan Nan Nan.'),Object(i.b)("li",{parentName:"ul"},"\u25a0 When entering a date, put the date in quotation marks and use the following format: yyyy-mm-dd, that is, four digit year, two digit month and two digit date."),Object(i.b)("li",{parentName:"ul"},'\u25a0 If the expression is not in a valid date range (for example, mm is not between 01 and 12), the fields in the formula display "Nan Nan Nan".'),Object(i.b)("li",{parentName:"ul"},"\u25a0 The formula will always return the value of UTC (coordinated world time) 0, and \b unless the incoming parameter explicitly carries the time zone information, it will always use the user's time zone calculation. For example, DateValue ('2018-12-06:06 ') returns 2018-12-11, while DateValue ('2018-12-12t06:06:06z') returns 2018-12-12.")))),Object(i.b)("h2",{id:"datetimevalue"},"DATETIMEVALUE"),Object(i.b)("p",null,"Returns the year, month, day, and GMT time values."),Object(i.b)("p",null,Object(i.b)("strong",{parentName:"p"},"Use\uff1a")," DATETIMEVALUE\uff08expression\uff09"),Object(i.b)("p",null,Object(i.b)("strong",{parentName:"p"},"Parameter\uff1a")," ",Object(i.b)("inlineCode",{parentName:"p"},"text"),"\nText values, merged fields, or expressions in date / datetime format without TZ characters"),Object(i.b)("p",null,Object(i.b)("strong",{parentName:"p"},"Return value\uff1a")," Date time"),Object(i.b)("pre",null,Object(i.b)("code",Object(n.a)({parentName:"pre"},{className:"language-js"}),"DATETIMEVALUE(TEXT(ClosedDate))\n")),Object(i.b)("p",null,'The date time value is displayed based on the end date field value. The parameter closeddate must be a date type, not a date time type, because if closeddate is a date time type, text (closeddate) will return a character string with Z such as "2020-11-04 03:45:00z".'))}b.isMDXComponent=!0},121:function(e,t,a){"use strict";a.d(t,"a",(function(){return s})),a.d(t,"b",(function(){return u}));var n=a(0),r=a.n(n);function i(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function o(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function c(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?o(Object(a),!0).forEach((function(t){i(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):o(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function l(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},i=Object.keys(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var d=r.a.createContext({}),b=function(e){var t=r.a.useContext(d),a=t;return e&&(a="function"==typeof e?e(t):c(c({},t),e)),a},s=function(e){var t=b(e.components);return r.a.createElement(d.Provider,{value:t},e.children)},m={inlineCode:"code",wrapper:function(e){var t=e.children;return r.a.createElement(r.a.Fragment,{},t)}},p=r.a.forwardRef((function(e,t){var a=e.components,n=e.mdxType,i=e.originalType,o=e.parentName,d=l(e,["components","mdxType","originalType","parentName"]),s=b(a),p=n,u=s["".concat(o,".").concat(p)]||s[p]||m[p]||i;return a?r.a.createElement(u,c(c({ref:t},d),{},{components:a})):r.a.createElement(u,c({ref:t},d))}));function u(e,t){var a=arguments,n=t&&t.mdxType;if("string"==typeof e||n){var i=a.length,o=new Array(i);o[0]=p;var c={};for(var l in t)hasOwnProperty.call(t,l)&&(c[l]=t[l]);c.originalType=e,c.mdxType="string"==typeof e?e:n,o[1]=c;for(var d=2;d<i;d++)o[d]=a[d];return r.a.createElement.apply(null,o)}return r.a.createElement.apply(null,a)}p.displayName="MDXCreateElement"}}]);