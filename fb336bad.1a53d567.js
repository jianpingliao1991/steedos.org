(window.webpackJsonp=window.webpackJsonp||[]).push([[50],{114:function(e,t,a){"use strict";a.r(t),a.d(t,"frontMatter",(function(){return o})),a.d(t,"metadata",(function(){return d})),a.d(t,"rightToc",(function(){return s})),a.d(t,"default",(function(){return l}));var n=a(3),i=a(7),r=(a(0),a(121)),o={title:"Using Date, DateTime, and Time Values in Formulas",sidebar_label:"Date, DateTime, and Time Values"},d={unversionedId:"formula/date",id:"formula/date",isDocsHomePage:!1,title:"Using Date, DateTime, and Time Values in Formulas",description:"The name date to display uses two data types: date and datetime. Data type time does not include date values, such as working hours. Most of the values used when processing dates are date data types that store year, month, and day. Some fields, such as CreatedDate, are date time fields, meaning that they store not only date values, but also time values (stored in GMT, but displayed in the user's time zone). When viewed on the record details page, the date, date time, and time fields are formatted with the user's locale. The precision of the time value is in milliseconds. The precision of the datetime value is in seconds.",source:"@site/docs/formula/date.md",slug:"/formula/date",permalink:"/docs/formula/date",editUrl:"https://github.com/steedos/steedos.org/tree/master/docs/formula/date.md",version:"current",sidebar_label:"Date, DateTime, and Time Values",sidebar:"someSidebar",previous:{title:"Roll-Up Summary Field",permalink:"/docs/formula/summary_field"},next:{title:"Formula Best Practices",permalink:"/docs/formula/best_practices"}},s=[{value:"TODAY()\u3001NOW() and TIMENOW()",id:"today\u3001now-and-timenow",children:[]},{value:"The DATE\uff08\uff09function",id:"the-date\uff08\uff09function",children:[]},{value:"Convert between date time and date",id:"convert-between-date-time-and-date",children:[]},{value:"Convert between date time and time",id:"convert-between-date-time-and-time",children:[]},{value:"Convert between date and text",id:"convert-between-date-and-text",children:[]},{value:"Convert between date time and text",id:"convert-between-date-time-and-text",children:[]},{value:"Convert between time and text",id:"convert-between-time-and-text",children:[]},{value:"Notes about date time and time zone",id:"notes-about-date-time-and-time-zone",children:[]}],u={rightToc:s};function l(e){var t=e.components,a=Object(i.a)(e,["components"]);return Object(r.b)("wrapper",Object(n.a)({},u,a,{components:t,mdxType:"MDXLayout"}),Object(r.b)("p",null,"The name date to display uses two data types: date and datetime. Data type time does not include date values, such as working hours. Most of the values used when processing dates are date data types that store year, month, and day. Some fields, such as CreatedDate, are date time fields, meaning that they store not only date values, but also time values (stored in GMT, but displayed in the user's time zone). When viewed on the record details page, the date, date time, and time fields are formatted with the user's locale. The precision of the time value is in milliseconds. The precision of the datetime value is in seconds."),Object(r.b)("p",null,"You can use add and subtract operators on dates, datetimes, and time values to calculate future dates or past times between two dates or times. For example, if you subtract one date from another, the resulting value will be the difference (days) between the two initial values (numeric data type). The same operation between two datetime values returns a decimal value, representing the difference in days, hours, and minutes. The same operation of two time values returns milliseconds."),Object(r.b)("p",null,"For example, if the difference between two date time values is 5.52, this means that the two values are separated by 5 days, 12 hours (0.5 of a day), and 28 minutes (0.02 of a day). You can also add numeric values to the date and date time. For example, the action ",Object(r.b)("inlineCode",{parentName:"p"},"TODAY() + 3")," returns three days after today's date. "),Object(r.b)("p",null,"Throughout the example, variable dates and datetimes are used in place of actual date and datetime fields or values."),Object(r.b)("h2",{id:"today\u3001now-and-timenow"},"TODAY()\u3001NOW() and TIMENOW()"),Object(r.b)("ul",null,Object(r.b)("li",{parentName:"ul"},Object(r.b)("p",{parentName:"li"},"The TODAY() function returns the current day, month, and year as a date data category. This function is useful for formulas that want to know the number of days in the past, in some days in the future, or just want to display the current date.")),Object(r.b)("li",{parentName:"ul"},Object(r.b)("p",{parentName:"li"},"The NOW() function returns the date time value of the current time. This can be very useful when you are concerned about a specific time and date of the day.")),Object(r.b)("li",{parentName:"ul"},Object(r.b)("p",{parentName:"li"},"The TIMENOW() function returns the value of GMT and represents the current time without a date. If you need the current hour, minute, second, or millisecond, use this function instead of the NOW() function. This value is useful for tracking time(such as shift or elapsed time)"))),Object(r.b)("p",null,"For more information about how to convert between date and datetime values,please refer to ",Object(r.b)("a",Object(n.a)({parentName:"p"},{href:"#convert-between-date-time-and-date"}),"Convert between date time and date")),Object(r.b)("h2",{id:"the-date\uff08\uff09function"},"The DATE\uff08\uff09function"),Object(r.b)("p",null,"The date() function returns a date value, given the year, month, and day. The numeric Y / M / D values and the year(), month(), and day() functions are valid arguments for date(). For example, ",Object(r.b)("inlineCode",{parentName:"p"},"DATE( 2013, 6, 1 )"),"returns June 1, 2013. Similarly,",Object(r.b)("inlineCode",{parentName:"p"},"DATE( YEAR( TODAY() ), MONTH( TODAY() ) + 3, 1)")," returns the date value of the first day of three months from today in the current year, assuming that the date is valid (for example, months between 1 and 12)."),Object(r.b)("p",null,"If the Y / M / D value entered results in an invalid date, the DATE() function will not report an error, but will return a possible error value. For example, the DATE (2021,2,29) of non leap year will return 2021-03-01, and DATE (2021121,29) will return 2031-01-29. Therefore, error checking is an important part of using date values. You can read about handling invalid dates in the sample date format."),Object(r.b)("h2",{id:"convert-between-date-time-and-date"},"Convert between date time and date"),Object(r.b)("p",null,"Date and datetime are non exchangeable data types, so when you perform operations between date and datetime values, you need to convert them so that they have the same type. Some functions, such as",Object(r.b)("inlineCode",{parentName:"p"},"YEAR()"),"\u3001",Object(r.b)("inlineCode",{parentName:"p"},"MONTH()")," and ",Object(r.b)("inlineCode",{parentName:"p"},"DAY()"),", also apply to date values only, so you must first convert date time values."),Object(r.b)("p",null,"Use the ",Object(r.b)("inlineCode",{parentName:"p"},"DATEVALUE( date/time )")," function to return the date value of the date time. For example, to get the year from a datetime, use ",Object(r.b)("inlineCode",{parentName:"p"},"YEAR( DATEVALUE( date/time ) )")),Object(r.b)("p",null,"You can use the ",Object(r.b)("inlineCode",{parentName:"p"},"DATETIMEVALUE( TEXT(date) )")," function to convert a date value to a date time in GMT time zone. The time will be set to Greenwich mean time (GMT) and then displayed in all user time zones. For Beijing time, ",Object(r.b)("inlineCode",{parentName:"p"},"DATETIMEVALUE( TEXT(TODAY()) )")," will return to the utc0 of the day, and the Steedos interface will display 8:00 a.m. of that day instead of 00:00 of the same day. For more information, please refer to ",Object(r.b)("a",Object(n.a)({parentName:"p"},{href:"#notes-about-date-time-and-time-zone"}),"notes about date time and time zone")),Object(r.b)("h2",{id:"convert-between-date-time-and-time"},"Convert between date time and time"),Object(r.b)("p",null,"The time data type value returned by function TIMEVALUE() is converted between date time and time. The format of the value is ",Object(r.b)("inlineCode",{parentName:"p"},'"HH:MM:SS.MS"(hours:minutes:seconds.milliseconds)')," value in 24-hour format and functions H/M/S/MS, HOUR(), MINUTE(),SECOND() and MILLISECOND() are valid parameters of TIMEVALUE()."),Object(r.b)("p",null,"Use the TIMEVALUE(text) function to convert a text value, text type merge field or expression to a time type. For example, use ",Object(r.b)("inlineCode",{parentName:"p"},'TIMEVALUE(LPAD(TEXT(HOUR(ClosedDate)), 2, "0") & ":" & LPAD(TEXT(MINUTE(ClosedDate)), 2, "0") & ":" & LPAD(TEXT(SECOND(ClosedDate)), 2, "0") & "." & LPAD(TEXT(MILLISECOND(ClosedDate)), 3, "0"))')," to extract the time from the ClosedDate datetime value."),Object(r.b)("h2",{id:"convert-between-date-and-text"},"Convert between date and text"),Object(r.b)("p",null,"If you want to include the date as part of the string, include the date value in the text() function to convert to text. For example, if you want to convert today's date to text, use:\n",Object(r.b)("inlineCode",{parentName:"p"},'"Today\'s date is " & TEXT( TODAY() )')),Object(r.b)("p",null,'his returns the date in the format "YYYY-MM-DD" rather than the locale dependent format. You can change the formula by extracting the day, month, and year from the date, and then combining them according to the required format. For example:\n',Object(r.b)("inlineCode",{parentName:"p"},'"Today\'s date is " & TEXT( MONTH( date ) ) & "/" & TEXT( DAY( date ) ) & "/" & TEXT( YEAR( date ) )')),Object(r.b)("p",null,'You can also convert text to dates to use string values with your other date fields and formulas. You will want the text to have the format "YYYY-MM-DD". Use this formula to return a date value:\n',Object(r.b)("inlineCode",{parentName:"p"},'DATEVALUE( "YYYY-MM-DD" )')),Object(r.b)("h2",{id:"convert-between-date-time-and-text"},"Convert between date time and text"),Object(r.b)("p",null,"You can use the TEXT() function to include a date time value in a string, but be careful with the time zone. For example, consider this formula:\n",Object(r.b)("inlineCode",{parentName:"p"},'"The current date and time is " & TEXT( NOW() )')),Object(r.b)("p",null,'In this formula, NOW() is offset to GMT. Normally, NOW() will be converted to the user\'s time zone at view time, but because it is converted to text, the conversion does not occur. Therefore, if you execute this formula at 6:00 p.m. Beijing time (GMT-10) on August 1, the result is "The current date and time is 2021-08-01 10:00:00Z".'),Object(r.b)("p",null,'When the date time is converted to text, a "Z" is included at the end to represent GMT. If the field is empty, TEXT (date / time) will report an error. Therefore, if the datetime value you are using may be empty, check before converting to text:'),Object(r.b)("pre",null,Object(r.b)("code",Object(n.a)({parentName:"pre"},{className:"language-js"}),'IF(\n   ISBLANK( date/time ),\n   "",\n   TEXT( date/time )\n   )\n')),Object(r.b)("p",null,'To convert a string to a datetime value, use DATETIMEVALUE() to transfer the string in "YYYY-MM-DD HH:MM:SS"format. This method returns the date time value of GMT.'),Object(r.b)("h2",{id:"convert-between-time-and-text"},"Convert between time and text"),Object(r.b)("p",null,"If you want to include time as part of a string, encapsulate the time value in the TEXT() function to convert it to text. For example, if you want to return the current time as text, use:\n",Object(r.b)("inlineCode",{parentName:"p"},'"The time is " & TEXT( TIMENOW() )'),'\nThis function returns the time in the format "HH:MM:SS.MS"'),Object(r.b)("p",null,'You can also convert text to a time data type to use string values with other time fields and formulas. Format the text as "HH:MM:SS.MS" in a 24-hour format. Use the timevalue() function:\n',Object(r.b)("inlineCode",{parentName:"p"},'TIMEVALUE("17:30:45.125")')),Object(r.b)("h2",{id:"notes-about-date-time-and-time-zone"},"Notes about date time and time zone"),Object(r.b)("p",null,"The date and date time values are stored in GMT. After the record is saved, the field value is stored as the value in GMT time zone, and then displayed in the viewer's time zone when the record details page is displayed. There is no problem with date conversion, because converting date time to date yields the same date value."),Object(r.b)("p",null,"However, when the date time value is used, the conversion is always done in GMT rather than in the user's time zone. If you compare before two date time fields, there is no time zone problem because both fields are in the same time zone. However, when a value in the calculation is converted from a text or date value to a datetime value, the result will be different."),Object(r.b)("p",null,"Let's assume that Beijing users enter a value of 9:00 on August 2, 2020 in the custom date time field named Date_Time_c. The value is stored as 2020-08-02 01:00:00z because of the time zone difference of GMT + 8. At 21:00, August 2, Beijing time, the following formula fields are run when users edit records:\n",Object(r.b)("inlineCode",{parentName:"p"},"Date_Time_c - NOW()"),"\nIn the calculation, NOW() is 2020-08-02 13:00:00Z, and then subtracted from 2020-08-02 01:00:00Z to return the expected result of - 0.5 (- 12 hours)."),Object(r.b)("p",null,'Assuming that NOW() is not used, the formula will convert the string "2020-08-02 21:00:00" to the date time value:\n',Object(r.b)("inlineCode",{parentName:"p"},'Date_Time_c - DATETIMEVALUE( "2020-08-02 21:00:00")'),'\nIn this case, DATETIMEVALUE( "2020-08-02 21:00:00") is 2020-08-02 21:00:00Z, and the final result will return - 0.8333333333333334 (- 20 hours), which is different from the previous - 12 hours.'),Object(r.b)("p",null,"Assuming that the current time is still 21:00 Beijing time on November 10, 2020, i.e. 2020-11-10T13:00:00Z, replace the above now with the date function today:\n",Object(r.b)("inlineCode",{parentName:"p"},'TODAY() - DATEVALUE("2020-11-10T19:00:00Z")'),"\nThe result of calculation is 0, because both sides of the minus sign are Beijing time on November 10, 2020. However, if the current time is 7:00 a.m. Beijing time on November 10, 2020, because the difference between Beijing time and time zone is 8 hours, TODAY() will output 2020-11-09, and subtracting the two will get - 1 (- 24 hours)."),Object(r.b)("p",null,"Unable to determine the user's time zone in the formula. If all your users are in the same time zone, you can adjust the time zone difference to your converted value by adding or subtracting the time difference between the user's time zone and GMT. However, because time zones are affected by daylight saving time and DST start and end dates are different each year, it is difficult to manage them in formulas."))}l.isMDXComponent=!0},121:function(e,t,a){"use strict";a.d(t,"a",(function(){return m})),a.d(t,"b",(function(){return b}));var n=a(0),i=a.n(n);function r(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function o(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function d(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?o(Object(a),!0).forEach((function(t){r(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):o(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function s(e,t){if(null==e)return{};var a,n,i=function(e,t){if(null==e)return{};var a,n,i={},r=Object.keys(e);for(n=0;n<r.length;n++)a=r[n],t.indexOf(a)>=0||(i[a]=e[a]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(n=0;n<r.length;n++)a=r[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(i[a]=e[a])}return i}var u=i.a.createContext({}),l=function(e){var t=i.a.useContext(u),a=t;return e&&(a="function"==typeof e?e(t):d(d({},t),e)),a},m=function(e){var t=l(e.components);return i.a.createElement(u.Provider,{value:t},e.children)},c={inlineCode:"code",wrapper:function(e){var t=e.children;return i.a.createElement(i.a.Fragment,{},t)}},h=i.a.forwardRef((function(e,t){var a=e.components,n=e.mdxType,r=e.originalType,o=e.parentName,u=s(e,["components","mdxType","originalType","parentName"]),m=l(a),h=n,b=m["".concat(o,".").concat(h)]||m[h]||c[h]||r;return a?i.a.createElement(b,d(d({ref:t},u),{},{components:a})):i.a.createElement(b,d({ref:t},u))}));function b(e,t){var a=arguments,n=t&&t.mdxType;if("string"==typeof e||n){var r=a.length,o=new Array(r);o[0]=h;var d={};for(var s in t)hasOwnProperty.call(t,s)&&(d[s]=t[s]);d.originalType=e,d.mdxType="string"==typeof e?e:n,o[1]=d;for(var u=2;u<r;u++)o[u]=a[u];return i.a.createElement.apply(null,o)}return i.a.createElement.apply(null,a)}h.displayName="MDXCreateElement"}}]);