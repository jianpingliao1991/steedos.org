(window.webpackJsonp=window.webpackJsonp||[]).push([[19],{121:function(e,t,n){"use strict";n.d(t,"a",(function(){return b})),n.d(t,"b",(function(){return h}));var a=n(0),r=n.n(a);function l(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function c(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){l(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function o(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},l=Object.keys(e);for(a=0;a<l.length;a++)n=l[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)n=l[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var d=r.a.createContext({}),s=function(e){var t=r.a.useContext(d),n=t;return e&&(n="function"==typeof e?e(t):c(c({},t),e)),n},b=function(e){var t=s(e.components);return r.a.createElement(d.Provider,{value:t},e.children)},p={inlineCode:"code",wrapper:function(e){var t=e.children;return r.a.createElement(r.a.Fragment,{},t)}},u=r.a.forwardRef((function(e,t){var n=e.components,a=e.mdxType,l=e.originalType,i=e.parentName,d=o(e,["components","mdxType","originalType","parentName"]),b=s(n),u=a,h=b["".concat(i,".").concat(u)]||b[u]||p[u]||l;return n?r.a.createElement(h,c(c({ref:t},d),{},{components:n})):r.a.createElement(h,c({ref:t},d))}));function h(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var l=n.length,i=new Array(l);i[0]=u;var c={};for(var o in t)hasOwnProperty.call(t,o)&&(c[o]=t[o]);c.originalType=e,c.mdxType="string"==typeof e?e:a,i[1]=c;for(var d=2;d<l;d++)i[d]=n[d];return r.a.createElement.apply(null,i)}return r.a.createElement.apply(null,n)}u.displayName="MDXCreateElement"},83:function(e,t,n){"use strict";n.r(t),n.d(t,"frontMatter",(function(){return i})),n.d(t,"metadata",(function(){return c})),n.d(t,"rightToc",(function(){return o})),n.d(t,"default",(function(){return s}));var a=n(3),r=n(7),l=(n(0),n(121)),i={title:"Query data by GraphQL API",sidebar_label:"Query by GraphQL"},c={unversionedId:"api/graphql_query",id:"api/graphql_query",isDocsHomePage:!1,title:"Query data by GraphQL API",description:"Query data in GraphQL API, query criteria accept 5 parameters bellow, can be used together as needed.",source:"@site/docs/api/graphql_query.md",slug:"/api/graphql_query",permalink:"/docs/api/graphql_query",editUrl:"https://github.com/steedos/steedos.org/tree/master/docs/api/graphql_query.md",version:"current",sidebar_label:"Query by GraphQL",sidebar:"someSidebar",previous:{title:"Authorize the GraphQL API",permalink:"/docs/api/graphql_auth"},next:{title:"Insert data by GraphQL API",permalink:"/docs/api/graphql_add"}},o=[{value:"filters",id:"filters",children:[]},{value:"field structure detail",id:"field-structure-detail",children:[{value:"suffix __label",id:"suffix-__label",children:[]},{value:"prefix related__",id:"prefix-related__",children:[]}]},{value:"top and skip",id:"top-and-skip",children:[]},{value:"sort",id:"sort",children:[]},{value:"fields",id:"fields",children:[]}],d={rightToc:o};function s(e){var t=e.components,n=Object(r.a)(e,["components"]);return Object(l.b)("wrapper",Object(a.a)({},d,n,{components:t,mdxType:"MDXLayout"}),Object(l.b)("p",null,"Query data in GraphQL API, query criteria accept 5 parameters bellow, can be used together as needed."),Object(l.b)("ul",null,Object(l.b)("li",{parentName:"ul"},"filters: text or array"),Object(l.b)("li",{parentName:"ul"},"fields: array"),Object(l.b)("li",{parentName:"ul"},"top: number"),Object(l.b)("li",{parentName:"ul"},"skip: number"),Object(l.b)("li",{parentName:"ul"},"sort: text")),Object(l.b)("p",null,"They are enclosed in brackets after the object name like the following."),Object(l.b)("pre",null,Object(l.b)("code",Object(a.a)({parentName:"pre"},{className:"language-graphql"}),'leads(filters:[["status", "=", "Qualified"]], top:1, sort:"name desc")\n')),Object(l.b)("p",null,"When somebody access the GraphQL API on Steedos, they can see only the data they have permission to see, see ",Object(l.b)("a",Object(a.a)({parentName:"p"},{href:"/docs/api/graphql#about-data-permissions"}),"About data permissions")," for more information."),Object(l.b)("h2",{id:"filters"},"filters"),Object(l.b)("p",null,"You can add the query filters after the object name, the filters expression may be an array as a ",Object(l.b)("inlineCode",{parentName:"p"},"Steedos Filters")," like ",Object(l.b)("inlineCode",{parentName:"p"},'[["status", "=", "Qualified"]]')," or a text as a standard ",Object(l.b)("a",Object(a.a)({parentName:"p"},{href:"https://docs.oasis-open.org/odata/odata/v4.01/os/part1-protocol/odata-v4.01-os-part1-protocol.html#sec_SystemQueryOptionfilter"}),"OData filtering string")," like ",Object(l.b)("inlineCode",{parentName:"p"},"\"status eq 'Qualified'\""),"."),Object(l.b)("pre",null,Object(l.b)("code",Object(a.a)({parentName:"pre"},{className:"language-graphql"}),'query{\n  leads(filters:[["status", "=", "Qualified"]]){\n    name,\n    title,\n    status\n  }\n}\n')),Object(l.b)("p",null,"or"),Object(l.b)("pre",null,Object(l.b)("code",Object(a.a)({parentName:"pre"},{className:"language-graphql"}),"query{\n  leads(filters:\"status eq 'Qualified'\"){\n    name,\n    title,\n    status\n  }\n}\n")),Object(l.b)("h2",{id:"field-structure-detail"},"field structure detail"),Object(l.b)("p",null,"In a GraphQL query, you must define the field structure detail at the end of the object name and brackets."),Object(l.b)("p",null,"Thanks to this feature, you can extend the field indefinitely to query the relevant field value just like the following example."),Object(l.b)("p",null,"Request all lead records, along with extended fields information belonging to the relevant objects:"),Object(l.b)("pre",null,Object(l.b)("code",Object(a.a)({parentName:"pre"},{className:"language-graphql"}),"query{\n  leads{\n    name,\n    title,\n    status,\n    // highlight-start\n    converted_account {\n      name,\n      rating\n    },\n    converted_contact {\n      name,\n      account{\n        name\n      }\n    },\n    // highlight-end\n    converted\n  }\n}\n")),Object(l.b)("p",null,"Get predictable results:"),Object(l.b)("pre",null,Object(l.b)("code",Object(a.a)({parentName:"pre"},{className:"language-json"}),'{\n  "data": {\n    "leads": [\n      {\n        "name": "Lead A",\n        "title": "GM",\n        "status": "Qualified",\n        // highlight-start\n        "converted_account": {\n          "name": "Account B",\n          "rating": "Hot"\n        },\n        "converted_contact": {\n          "name": "Contact M",\n          "account": {\n            "name": "Account N"\n          }\n        },\n        // highlight-end\n        "converted": true\n      },\n      {\n        "name": "Lead B",\n        "title": "purchasing manager",\n        "status": "New",\n        "converted_account": null,\n        "converted_contact": null,\n        "converted": null\n      }\n    ]\n  }\n}\n')),Object(l.b)("h3",{id:"suffix-__label"},"suffix __label"),Object(l.b)("p",null,"If the GraqhQL script has some field that return Date, DateTime, Boolean, etc., and you want to display them directly to your customers, you need to add the ",Object(l.b)("inlineCode",{parentName:"p"},"__label")," suffix after the field name to indicate that you want to format the field value, otherwise it will return the content of the field stored in the database directly."),Object(l.b)("h4",{id:"datedatetime"},"Date/DateTime"),Object(l.b)("p",null,"For example, the ",Object(l.b)("inlineCode",{parentName:"p"},"created")," field indicates the creation time, it will return a non-semantic value such as ",Object(l.b)("inlineCode",{parentName:"p"},"1608621469293"),", but ",Object(l.b)("inlineCode",{parentName:"p"},"created__label")," will return formatted like ",Object(l.b)("inlineCode",{parentName:"p"},"2020-12-22 15:17")," with a good reading experience result."),Object(l.b)("p",null,Object(l.b)("em",{parentName:"p"},"If the ",Object(l.b)("inlineCode",{parentName:"em"},"created")," field is a empty value, then it will return ",Object(l.b)("inlineCode",{parentName:"em"},"null")," and ",Object(l.b)("inlineCode",{parentName:"em"},"created__label")," will return a empty string ",Object(l.b)("inlineCode",{parentName:"em"},'""'),".")),Object(l.b)("h4",{id:"boolean"},"Boolean"),Object(l.b)("p",null,"For example, the ",Object(l.b)("inlineCode",{parentName:"p"},"converted")," field indicates whether it is a converted record, it will return a character like ",Object(l.b)("inlineCode",{parentName:"p"},"true")," or ",Object(l.b)("inlineCode",{parentName:"p"},"false"),", but the ",Object(l.b)("inlineCode",{parentName:"p"},"converted__label")," will return a result with a good reading experience like ",Object(l.b)("inlineCode",{parentName:"p"},'"Yes"')," or ",Object(l.b)("inlineCode",{parentName:"p"},'"No"'),"."),Object(l.b)("p",null,Object(l.b)("em",{parentName:"p"},"If the ",Object(l.b)("inlineCode",{parentName:"em"},"converted")," field is a empty value, then it will return ",Object(l.b)("inlineCode",{parentName:"em"},"null")," and ",Object(l.b)("inlineCode",{parentName:"em"},"created__label")," will return a string ",Object(l.b)("inlineCode",{parentName:"em"},'"No"'),".")),Object(l.b)("p",null,"Request all lead records, with some ",Object(l.b)("inlineCode",{parentName:"p"},"__label")," suffix fields in it:"),Object(l.b)("pre",null,Object(l.b)("code",Object(a.a)({parentName:"pre"},{className:"language-graphql"}),"query{\n  leads{\n    name,\n    title,\n    // highlight-start\n    converted,\n    converted__label,\n    // highlight-end\n    // highlight-start\n    created,\n    created__label\n    // highlight-end\n  }\n}\n")),Object(l.b)("p",null,"Get predictable results:"),Object(l.b)("pre",null,Object(l.b)("code",Object(a.a)({parentName:"pre"},{className:"language-json"}),'{\n  "data": {\n    "leads": [\n      {\n        "name": "Lead A",\n        "title": "GM",\n        // highlight-start\n        "converted": true,\n        "converted__label": "Yes",\n        "created": "1597979950012",\n        "created__label": "2020-08-21 11:19"\n        // highlight-end\n      },\n      {\n        "name": "Lead B",\n        "title": "purchasing manager",\n        // highlight-start\n        "converted": false,\n        "converted__label": "No",\n        "created": "1597988499634",\n        "created__label": "2020-08-21 13:41"\n        // highlight-end\n      },\n      {\n        "name": "Lead C",\n        "title": "CMO",\n        // highlight-start\n        "converted": null,\n        "converted__label": "No",\n        "created": null,\n        "created__label": ""\n        // highlight-end\n      }\n    ]\n  }\n}\n')),Object(l.b)("div",{className:"admonition admonition-note alert alert--secondary"},Object(l.b)("div",Object(a.a)({parentName:"div"},{className:"admonition-heading"}),Object(l.b)("h5",{parentName:"div"},Object(l.b)("span",Object(a.a)({parentName:"h5"},{className:"admonition-icon"}),Object(l.b)("svg",Object(a.a)({parentName:"span"},{xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"}),Object(l.b)("path",Object(a.a)({parentName:"svg"},{fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"})))),"Note")),Object(l.b)("div",Object(a.a)({parentName:"div"},{className:"admonition-content"}),Object(l.b)("p",{parentName:"div"},"If you use GraphQL API to fetch data and show them in the Steedos Page, you shouldn't to add the ",Object(l.b)("inlineCode",{parentName:"p"},"__label")," suffix after the field name, because the Steedos Page will format them auto."),Object(l.b)("p",{parentName:"div"},"Only when you want to display the field value directly to your customers, you will need to add the ",Object(l.b)("inlineCode",{parentName:"p"},"__label")," suffix after the field name."))),Object(l.b)("h3",{id:"prefix-related__"},"prefix related__"),Object(l.b)("p",null,"If you want each record in the list returned by the GraphQL API interface to carry the associated sub-object records information, you can use ",Object(l.b)("inlineCode",{parentName:"p"},"related__")," as a prefix to splice the name of the associated sub-object to achieve the goal."),Object(l.b)("p",null,"What is sub-object? That means you have two object associated by a ",Object(l.b)("inlineCode",{parentName:"p"},"Master Detail")," relationship field, One is Master Object, another is Detail Object, and the sub-object is exactly the Detail Object. "),Object(l.b)("p",null,"Request all lead records, with some ",Object(l.b)("inlineCode",{parentName:"p"},"related__")," prefix fields to fetch the sub-object records for every records:"),Object(l.b)("pre",null,Object(l.b)("code",Object(a.a)({parentName:"pre"},{className:"language-graphql"}),"query{\n  leads{\n    name,\n    title,\n    // highlight-start\n    related__tasks{\n      name,\n      assignees{\n        name\n      },\n      due_date,\n      due_date__label\n    }\n    // highlight-end\n  }\n}\n")),Object(l.b)("p",null,"Get predictable results:"),Object(l.b)("pre",null,Object(l.b)("code",Object(a.a)({parentName:"pre"},{className:"language-json"}),'{\n  "data": {\n    "leads": [\n      {\n        "name": "Lead A",\n        "title": "GM",\n        // highlight-start\n        "related__tasks": [\n          {\n            "name": "Task 1",\n            "assignees": [\n              {\n                "name": "Litant"\n              }\n            ],\n            "due_date": "1611964800000",\n            "due_date__label": "2021-01-30"\n          }\n        ]\n        // highlight-end\n      },\n      {\n        "name": "Lead B",\n        "title": "purchasing manager",\n        // highlight-start\n        "related__tasks": [\n          {\n            "name": "Task 2",\n            "assignees": [\n              {\n                "name": "John"\n              }\n            ],\n            "due_date": "1611964800000",\n            "due_date__label": "2021-01-30"\n          }\n        ]\n        // highlight-end\n      }\n    ]\n  }\n}\n')),Object(l.b)("div",{className:"admonition admonition-note alert alert--secondary"},Object(l.b)("div",Object(a.a)({parentName:"div"},{className:"admonition-heading"}),Object(l.b)("h5",{parentName:"div"},Object(l.b)("span",Object(a.a)({parentName:"h5"},{className:"admonition-icon"}),Object(l.b)("svg",Object(a.a)({parentName:"span"},{xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"}),Object(l.b)("path",Object(a.a)({parentName:"svg"},{fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"})))),"Note")),Object(l.b)("div",Object(a.a)({parentName:"div"},{className:"admonition-content"}),Object(l.b)("p",{parentName:"div"},"The field name ",Object(l.b)("inlineCode",{parentName:"p"},"related__tasks")," in the example above based on there is a object named 'tasks' who has a ",Object(l.b)("inlineCode",{parentName:"p"},"master-detail")," field associated to the Master Object ",Object(l.b)("inlineCode",{parentName:"p"},"leads"),". "))),Object(l.b)("h2",{id:"top-and-skip"},"top and skip"),Object(l.b)("p",null,"You can define how many records you want to skip with a ",Object(l.b)("inlineCode",{parentName:"p"},"skip")," word, and how many record you want to return with a ",Object(l.b)("inlineCode",{parentName:"p"},"top")," word."),Object(l.b)("p",null,"The query bellow will only return the second record."),Object(l.b)("pre",null,Object(l.b)("code",Object(a.a)({parentName:"pre"},{className:"language-graphql"}),'query{\n  leads(fields:["name"], top:1, skip:1){\n    name,\n    title\n  }\n}\n')),Object(l.b)("h2",{id:"sort"},"sort"),Object(l.b)("p",null,"You can define how you want to sort the results with the ",Object(l.b)("inlineCode",{parentName:"p"},"sort")," word."),Object(l.b)("p",null,"A key word named 'desc' represents descending order, and a key word named \u2018asc\u2019 represents ascending order."),Object(l.b)("p",null,"The query bellow will sort in descending order by field ",Object(l.b)("inlineCode",{parentName:"p"},"name")," to return the results."),Object(l.b)("pre",null,Object(l.b)("code",Object(a.a)({parentName:"pre"},{className:"language-graphql"}),'query{\n  leads(fields:["name"], sort:"name desc"){\n    name,\n    title\n  }\n}\n')),Object(l.b)("h2",{id:"fields"},"fields"),Object(l.b)("p",null,"You can add the query fields after the object name, that represents the which fields on the object you want to fetch."),Object(l.b)("p",null,"This property is always omitted, because you must define the field structure detail at the end of the object name and brackets, so we recommend you to omit this property."),Object(l.b)("pre",null,Object(l.b)("code",Object(a.a)({parentName:"pre"},{className:"language-graphql"}),'query{\n  leads(fields:["name"]){\n    name,\n    title\n  }\n}\n')),Object(l.b)("p",null,"The results is like bellow:"),Object(l.b)("pre",null,Object(l.b)("code",Object(a.a)({parentName:"pre"},{className:"language-json"}),'{\n  "data": {\n    "leads": [\n      {\n        "name": "T1",\n        "title": null\n      },\n      {\n        "name": "T2",\n        "title": null\n      }\n    ]\n  }\n}\n')),Object(l.b)("div",{className:"admonition admonition-note alert alert--secondary"},Object(l.b)("div",Object(a.a)({parentName:"div"},{className:"admonition-heading"}),Object(l.b)("h5",{parentName:"div"},Object(l.b)("span",Object(a.a)({parentName:"h5"},{className:"admonition-icon"}),Object(l.b)("svg",Object(a.a)({parentName:"span"},{xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"}),Object(l.b)("path",Object(a.a)({parentName:"svg"},{fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"})))),"Note")),Object(l.b)("div",Object(a.a)({parentName:"div"},{className:"admonition-content"}),Object(l.b)("p",{parentName:"div"},"As you see, if there are some fields in the ",Object(l.b)("a",Object(a.a)({parentName:"p"},{href:"#field-structure-detail"}),"field structure detail")," that are not defined in the ",Object(l.b)("inlineCode",{parentName:"p"},"fields")," property, these missed fields will be ignored and a null value is returned."))))}s.isMDXComponent=!0}}]);